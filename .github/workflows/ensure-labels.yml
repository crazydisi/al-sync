name: Ensure Labels
on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

permissions:
  contents: read
  issues: write

jobs:
  create-labels:
    runs-on: ubuntu-latest
    steps:
      - name: Ensure 'dependencies' label exists
        uses: actions/github-script@v7
        with:
          script: |
            const owner = context.repo.owner;
            const repo = context.repo.repo;
            const name = 'dependencies';
            const color = '0366d6';
            const description = 'Dependency update pull requests';

            try {
              await github.rest.issues.getLabel({ owner, repo, name });
              await github.rest.issues.updateLabel({ owner, repo, name, color, description });
              core.info(`Updated label: ${name}`);
            } catch (err) {
              if (err.status === 404) {
                await github.rest.issues.createLabel({ owner, repo, name, color, description });
                core.info(`Created label: ${name}`);
              } else {
                throw err;
              }
            }
